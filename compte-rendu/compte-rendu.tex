

\documentclass[a4paper,11pt]{article}
\usepackage[latin1]{inputenc}
\usepackage[cyr]{aeguill}
\usepackage[margin=0.8in]{geometry}
\usepackage{xspace}
\usepackage{amsmath}
\usepackage[english,francais]{babel}
\usepackage{url}
\usepackage{algorithm}
\usepackage{algpseudocode}
\usepackage{xcolor}
\usepackage{listings} % pour le code
\usepackage{graphicx} % pour les figures

% Redefinition de la commande \url pour pour l'utiliser dans un document en français
% sans avoir de problème avec les deux-points
% (voir http://perso.mines-albi.fr/~gaborit/latex/latex-in-french.html)
\let\urlorig\url
\renewcommand{\url}[1]{%
  \begin{otherlanguage}{english}\urlorig{#1}\end{otherlanguage}%
}
\renewcommand{\contentsname}{Sommaire} % si tableofcontents au début
\newcommand{\Numero}{\No}
\newcommand{\numero}{\no}


% Pour inclure joliment des scripts R
\lstset{
language=R,
basicstyle=\scriptsize\ttfamily,
commentstyle=\ttfamily\color{gray},
numbers=left,
numberstyle=\ttfamily\color{gray}\footnotesize,
stepnumber=1,
numbersep=5pt,
backgroundcolor=\color{white},
showspaces=false,
showstringspaces=false,
showtabs=false,
frame=single,
tabsize=2,
captionpos=b,
breaklines=true,
breakatwhitespace=false,
title=\lstname,
escapeinside={},
keywordstyle={},
morekeywords={}
}

\begin{document}

\title{Compte-rendu du TP \\``Evaluation empirique d'un programme''}
\author{Nom, prénom et parcours de chaque étudiant}
\date{\today}
\maketitle

\tableofcontents
\newpage

Vous devrez rendre ce rapport complété au format PDF exclusivement, en l'uploadant dans la colonne RenduTPEvalPerf de l'UE M2COM dans Tomuss (\url{http://tomuss.univ-lyon1.fr}), avant le 26 janvier à 23h59. N'envoyez pas d'email. Ne rendez pas le code source Latex. Ne rendez pas non plus d'autres fichiers (données brutes sous Excel, figures, code C, etc). Les figures pertinentes et les lignes de code que vous avez modifiées devront être incluses dans le rapport PDF. La taille maximale de ce rapport est de 15 pages.

\section{Présentation sommaire du programme à évaluer}

\subsection{Données à fournir en entrée}

\subsection{Données fournies en sortie}

\subsection{Algorithme}

Décrivez en français ce que vous avez compris de l'algorithme. Expliquez entre autres ce que représentent $n$, $m$, et $k$, et en quoi l'algorithme est stochastique. Vous pouvez en plus écrire l'algorithme sous forme de pseudocode (bonus). Voir  \url{https://en.wikibooks.org/wiki/LaTeX/Algorithms#Typesetting_using_the_algorithmic_package} pour plus d'informations.

\begin{algorithm}
\caption{<your caption for this algorithm>}
\label{<your label for references later in your document>}
\begin{algorithmic}
% A remplacer par votre pseudocode
\If {$i\geq maxval$}
    \State $i\gets 0$
\Else
    \If {$i+k\leq maxval$}
        \State $i\gets i+k$
    \EndIf
\EndIf
\end{algorithmic}
\end{algorithm}


\section{Premières mesures du temps d'exécution}

\subsection{Paramètres utilisés dans toute cette section}
Indiquez ici les valeurs de $m$ et $k$ avec lesquelles vous avez travaillé pour cette section. Indiquez également le ou les fichiers d'entrée utilisé(s) et la ou les valeur(s) de $n$ correspondantes. Indiquez également votre environnement de travail : système d'exploitation, compilateur (version), options de compilation, processeur, mémoire vive, etc. 

Pour chacune des sous-sections suivantes, indiquez le nombre de runs effectués pour soutenir vos résultats.

\subsection{Mise en évidence de la stochasticité de l'algorithme}
Montrez la variabilité obtenue dans les temps d'exécution en incluant un histogramme du temps CPU dans votre rapport (Figure \ref{fig:histo-variabilite}). Quantifiez cette variabilité en indiquant l'écart-type de ce temps d'exécution (sans oublier de préciser le nombre de runs sur lequel cet écart-type a été calculé). 

\begin{figure}[htbp]
	\begin{center}
		% remplacez par votre figure 
		\includegraphics[width=6cm]{Black_cherry_tree_histogram.pdf}
		\caption{Black cherry tree histogram. Source: Wikimedia Commons.}
		\label{fig:histo-variabilite}
	\end{center}
\end{figure}


Puis décrivez la manipulation que vous avez effectuée pour montrer qu'une grande part de cette variabilité provient de la stochasticité de l'algorithme. 


\subsection{Influence de la charge système}
En vous appuyant sur le cours, expliquez pourquoi le temps CPU, bien que fait pour être le plus indépendant possible de la charge système, peut tout de même être influencé par la charge système en pratique. Décrivez l'expérience que vous avez effectuée pour tester cet effet et synthétisez-en les résultats, en appuyant vos affirmations sur des chiffres. 

\subsection{Influence des options de compilation}
Quantifiez le gain de performance obtenu en passant d'une compilation en mode debug à une compilation en mode release (option d'optimisation) : indiquez le pourcentage d'amélioration ainsi que la façon dont vous l'avez calculé (formule, mais aussi nombre de runs, etc).

\section{Opération dominante}

\subsection{Paramètres utilisés dans toute cette section}

\subsection{Identification de l'opération dominante}
Indiquez le ou les outils de profilage utilisés pour trouver l'opération dominante. Pour appuyer votre réponse, vous pouvez copier-coller un extrait du rapport de profilage, ou inclure une capture d'écran comme figure.

\subsection{Comptage des appels à l'opération dominante}
Indiquez ici les lignes de code que vous avez modifiées pour compter les appels à l'opération dominante.

\begin{lstlisting}[language=C]
/* A remplacer par les passages que vous avez modifiés */
int i = 0;
float v = 5.9;
\end{lstlisting}

\section{Analyse de l'expérience fournie par R. Thion}

Rappelez le ou les objectifs de cette expérience (voir la partie 4 du sujet de TP) : à quelle(s) question(s) va-t-on répondre ?

\subsection{Plan d'expérience}
Rappelez ici le plan de l'expérience qui vous a été fournie :
\begin{itemize}
	\item Variables mesurées
	\item Paramètres que l'on a fait varier, et les valeurs choisies (sans oublier les fichiers d'entrée).
	\item Mode de combinaison des valeurs de paramètres (par exemple : full factorial design, si toutes les combinaisons possibles ont été testées)
	\item Nombre de runs effectués pour chaque combinaison de valeurs de paramètre
	\item Environnement de test
\end{itemize}

\subsection{Analyse des résultats}
Synthétisez les résultats obtenus à l'aide de trois figures maximum. Commentez-les et indiquez dans le texte principal les coefficients de détermination des régressions linéaires ($R^2$), les coefficients de corrélation et leurs p-values, etc.  Concluez sur les questions posées au début de cette section.


\section{Conception et réalisation de votre expérience}
Indiquez ici le ou les objectifs de votre propre expérience (voir la partie 4 du sujet de TP, éventuellement enrichie de vos propres questions additionnelles).

\subsection{Plan d'expérience}
Décrivez ici votre plan d'expérience :
\begin{itemize}
	\item Variables mesurées
	\item Paramètres que vous avez fait varier, et les valeurs choisies (justifiez). On peut considérer ici que les fichiers d'entrée font partie des paramètres, donc inpliquez lesquels vous avez choisis et expliquez pourquoi.
	\item Mode de combinaison des valeurs de paramètres (par exemple : full factorial design, si toutes les combinaisons possibles ont été testées)
	\item Nombre de runs effectués pour chaque combinaison de valeurs de paramètre
	\item Environnement de test
\end{itemize}

Si vous avez utilisé un outil de type ``cahier de laboratoire'' (papier ou numérique), indiquez-le ici, en incluant une figure (scan ou copie d'écran).

\subsection{Analyse des résultats}
Synthétisez les résultats obtenus à l'aide de trois figures maximum, et commentez-les. Les relations obtenues correspondent-elles à ce qu'on attend étant donné l'algorithme ? Quelle est l'influence de chaque paramètre ? Obtenez-vous les mêmes résultats qu'avec l'expérience fournie ?

\section{Annexe : Code réalisé pour le tutoriel sur les tests d'hypothèse}

\begin{lstlisting}[language=R]
#######################
# Cas ou H0 est vraie 
####################### 

# On va considerer deux populations qui ont exactement
# les memes parametres : les deux sont uniformement 
# distribuees entre 0 et 1. Les deux populations ont
# donc la meme moyenne, en l'occurrence 0.5. 
# Puis nous allons faire une experience : 
# - tirer un petit echantillon dans chaque population
# - calculer la moyenne observee dans l'echantillon 1,
#   puis celle observee dans l'echantillon 2. On 
#   n'obtiendra pas exactement 0.5 ni pour l'une ni pour 
#   l'autre.
# - calculer la difference entre les deux moyennes 
#   d'echantillons. Appelons d cette difference.

tirerEchantillonPop1H0 <- function(n) {
	vraieMoyenne <- 0.5
	plageDeDispersion <- 1.0
	min <- vraieMoyenne - plageDeDispersion/2.0
	max <- vraieMoyenne + plageDeDispersion/2.0
	ech <- runif(n, min, max)
	return(ech)
}

tirerEchantillonPop2H0 <- function(n) {
	vraieMoyenne <- 0.5
	plageDeDispersion <- 1.0
	min <- vraieMoyenne - plageDeDispersion/2.0
	max <- vraieMoyenne + plageDeDispersion/2.0
	ech <- runif(n, min, max)
	return(ech)
}

# Ecrire ici le code permettant de faire une "experience"
# c'est a dire tirer un echantillon de taille 20 dans 
# chaque population et mesurer la difference d observee
# entre les 2 moyennes d'echantillon.
pop1 <- tirerEchantillonPop1H0(20)
pop2 <- tirerEchantillonPop2H0(20)

mean(pop1)
mean(pop2)
abs(mean(pop1) - mean(pop2))
abs(mean(tirerEchantillonPop1H0(20)) - mean(tirerEchantillonPop2H0(20)))

# Si 1000 etudiants font independamment cette experience,
# chaque etudiant aura des echantillons differents et donc
# chacun aura une valeur differente pour d. Si nous 
# mettons toutes ces 1000 valeurs ensemble dans un vecteur
# (appele diffMoyH0), quelle sera la moyenne de ce vecteur ?

diffMoyH0 = c()

for(i in  1:1000)
{
	diffMoyH0 = c(diffMoyH0, abs(mean(tirerEchantillonPop1H0(20)) - mean(tirerEchantillonPop2H0(20))))
}

# On affiche la moyenne totale.
mean(diffMoyH0)

# On affiche les 1000 valeurs sur un histogramme.
plot(diffMoyH0)
abline(h=mean(diffMoyH0), col="red")

\end{lstlisting}

On obtient une moyenne de 0,07.

\begin{lstlisting}[language=R]

#######################
# Cas ou H1 est vraie 
####################### 

# On va voir comment se comporte notre indicateur quand 
# les deux populations n'ont pas la meme moyenne
# (mais ont tout de meme la meme dispersion)
# eg . pop1 comprise entre 0.0 et 1.0
#   et pop2 comprise entre 0.2 et 1.2 

tirerEchantillonPop1H1 <- function(n) {
vraieMoyenne <- 0.5
plageDeDispersion <- 1.0
min <- vraieMoyenne - plageDeDispersion/2.0
max <- vraieMoyenne + plageDeDispersion/2.0
ech <- runif(n, min, max)
return(ech)
}

tirerEchantillonPop2H1 <- function(n) {
vraieMoyenne <- 0.7
plageDeDispersion <- 1.0
min <- vraieMoyenne - plageDeDispersion/2.0
max <- vraieMoyenne + plageDeDispersion/2.0
ech <- runif(n, min, max)
return(ech)
}


# Ecrire ici le code pour faire les 1000 experiences 
# comme precedemment, en nommant cette fois le vecteur
# diffMoyH1. Calculez sa moyenne et tracez son histogramme.

diffMoyH1 = c()

for(i in  1:1000)
{
	diffMoyH1 = c(diffMoyH1, abs(mean(tirerEchantillonPop1H1(20)) - mean(tirerEchantillonPop2H1(20))))
}

# On affiche la moyenne totale.
mean(diffMoyH1)

# On affiche les 1000 valeurs sur un histogramme.
plot(diffMoyH1)
abline(h=mean(diffMoyH1), col="red")

\end{lstlisting}

On obtient une moyenne de 0,2.

\begin{figure}[htbp]
	\begin{center}
		% remplacez par votre figure 
		\includegraphics[width=12cm]{diffMoy.pdf}
		\caption{Graphique représentant diffMoyH0 et diffMoyH1 ainsi que leur moyenne.}
		\label{fig:diffMoy}
	\end{center}
\end{figure}


Placons nous maintenant dans le cas ou l'on ait fait
une seule experience.

Ecrire le code pour evaluer la plausibilite de H0: "les deux 
echantillons proviennent de deux populations qui ont la meme moyenne".

\begin{lstlisting}[language=R]
cMean <- function(v1, v2)
{
	return(abs(mean(v1) - mean(v2)))
}
sameMean <- function(v1, v2)
{
	return(cMean(v1, v2) < 0.1)
}

sameMean(tirerEchantillonPop1H0(20), tirerEchantillonPop2H0(20))
sameMean(tirerEchantillonPop1H1(20), tirerEchantillonPop2H1(20))

x1 <- c(0.97050525, 0.13734516, 0.80793033, 0.05207726, 0.62629180, 0.93485856,
0.58220744, 0.65935145, 0.76467195, 0.73512414, 0.45139560, 0.93225380,
0.53790595, 0.99845675, 0.31035081, 0.43082815, 0.15475353, 0.42647652,
0.65676067, 0.74186048)
x2 <- c(0.33565036, 0.28830545, 0.51556544, 0.93223089, 0.29192576, 0.43505823,
0.63127002, 0.86082799, 0.56533392, 0.19083212, 0.13087779, 0.09849703,
0.98921291, 0.91480756, 0.78556552, 0.33859160, 0.88482223, 0.76701274,
0.24190609, 0.46251866)

cMean(x1, x2)
sameMean(x1, x2)
\end{lstlisting}

Ici, sameMean(x1, x2) retourne "TRUE", ce qui signifie que les deux échantillons ont une moyenne proche l'une de l'autre.

\begin{figure}[htbp]
	\begin{center}
		% remplacez par votre figure 
		\includegraphics[width=12cm]{x1-x2-1.pdf}
		\caption{Graphique représentant x1 and x2 ainsi que leur moyenne.}
		\label{fig:x1-x2-1}
	\end{center}
\end{figure}

\begin{lstlisting}[language=R]
x1 <- c(0.41236444, 0.28422821, 0.15093798, 0.05885328, 0.25514435, 0.63026931,
0.56325462, 0.76304859, 0.56523993, 0.92535660, 0.10898729, 0.51579642,
0.07223967, 0.53483839, 0.52516575, 0.20250815, 0.89634680, 0.53879059,
0.58736912, 0.53945749)
x2 <- c(1.0809923, 0.5772333, 0.7252340, 1.1529082, 1.0924642, 0.6046166, 0.9495800,
0.3019857, 0.7701195, 1.0746508, 0.3928894, 1.0885017, 0.5101510, 1.1871599,
0.7953318, 0.5711237, 0.5505642, 0.9854085, 0.5105643, 0.9601635)

cMean(x1, x2)
sameMean(x1, x2)
\end{lstlisting}

Ici, sameMean(x1, x2) retourne "FALSE", ce qui signifie que les deux échantillons ont une moyenne bien différente l'une de l'autre.

\begin{figure}[htbp]
	\begin{center}
		% remplacez par votre figure 
		\includegraphics[width=12cm]{x1-x2-2.pdf}
		\caption{Graphique représentant x1 and x2 ainsi que leur moyenne.}
		\label{fig:x1-x2-2}
	\end{center}
\end{figure}


Incorporez également les histogrammes obtenus sous forme de figures. Indiquez vos conclusions sur les deux paires d'échantillons. 


\end{document}